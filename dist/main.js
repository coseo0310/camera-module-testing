"use strict";var __awaiter=function(t,d,h,a){return new(h=h||Promise)(function(i,e){function o(t){try{c(a.next(t))}catch(t){e(t)}}function n(t){try{c(a.throw(t))}catch(t){e(t)}}function c(t){var e;t.done?i(t.value):((e=t.value)instanceof h?e:new h(function(t){t(e)})).then(o,n)}c((a=a.apply(t,d||[])).next())})};const container=document.querySelector(".container"),canvas=document.querySelector("#canvas"),ctx=canvas.getContext("2d"),video=document.querySelector("#video"),btn1=document.querySelector(".capture");let width=container.clientWidth,height=container.clientHeight,videoWidth=1920,videoHeight=1080,rotate="horizontal",isCapture=!1,section={dx:0,dy:0,width:0,height:0};window.addEventListener("resize",t=>__awaiter(void 0,void 0,void 0,function*(){width=container.clientWidth,height=container.clientHeight;let t;(t=width>height?"horizontal":"vertical")!==rotate&&(rotate=t,setSection(),setDevice())})),btn1.addEventListener("click",()=>{capture()});const isMobile=navigator.userAgent.toLocaleLowerCase().includes("mobile");function setDevice(){return __awaiter(this,void 0,void 0,function*(){try{var t={audio:!1,video:{facingMode:"environment",width:1280,height:720}},e={audio:!1,video:{width:videoWidth,height:videoHeight}},i=yield navigator.mediaDevices.getUserMedia(isMobile?t:e);"horizontal"===rotate?(video.width=width,video.height=.5625*width):(video.width=height/.5625,video.height=height),video.srcObject=i}catch(t){console.error(t)}})}function capture(){btn1.classList.toggle("on"),setSection(),isCapture=!isCapture&&(canvas.width=video.clientWidth,canvas.height=video.clientHeight,ctx.drawImage(video,0,0,video.width,video.height),!0)}function clear(){ctx.clearRect(0,0,canvas.width,canvas.height)}function setSection(){clear(),"horizontal"===rotate?(section.dx=100,section.dy=20):(section.dx=20,section.dy=100),section.width=width-2*section.dx,section.height=height-2*section.dy,canvas.width=width,canvas.height=height,ctx.save(),ctx.strokeStyle="lightgoldenrodyellow",ctx.lineWidth=3,ctx.strokeRect(section.dx,section.dy,section.width,section.height),ctx.restore()}window.onload=()=>__awaiter(void 0,void 0,void 0,function*(){width=container.clientWidth,height=container.clientHeight;let t;t=width>height?"horizontal":"vertical",rotate=t,setSection(),setDevice()});
